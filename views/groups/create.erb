<div class="" style="float:left; width:49%; padding:5px; position:fixed; top:100px; left:5px;">
<h2>Create Group</h2>
<br/>
<form id="groupForm" action="/groups" method="post">
  <label for="post_title">Tags:</label>
  <input id="post_title" name="post[tags]" type="text" value="default" size="77"/>
  <input id="post_elements" name="post[elements]" type="text" value="">
  <input id="post_level" name="post[level]" type="text" value="1">
  <br/>
  <br/>
  <label for="post_body">Inhalt:</label><br>
  <div id="holder">
  
  </div>
  <br />
  <input type="submit" value="Create!"/>
</form> 
</div>
<div style="float:right; width:49%">
	<div>
		<img id="img_groupToggle" src="/Icons/Hide.png" onclick="ToggleGroups()" style="width:12px; height:12px; margin-right:4px;"/><h2 style="display:inline">Groups</h2>
		<div id="group_list">
			<a class="button" style="float:right;" onclick="HideAll()">Collapse all</a>
			<a class="button" style="float:right;" onclick="ShowAll()">Expand all</a><br>
			<div id="groups_tree">
				<%= @tree %>
			</div>
		</div>
	</div><br>
	
	<div>
	<img id="img_caseToggle" src="/Icons/Hide.png" onclick="ToggleCases()" style="width:12px; height:12px; margin-right:4px;"/><h2 style="display:inline">Cases</h2>
		<div id="case_list">
			<% @cases.each do |c| %>
			  <div class="case" id="<%= c.tags %>">
				<h4><a id="<%= c.id %>" class="myButton" onclick="AddMe(event)" data-level="0" ><%= "<< ##{c.id} #{c.tags}" %></a></h4>
				<p><code class="code"><%= c.code %></code>
				<p>Created: <%= c.created_at %></p>
			  </div>
			<% end %>
		</div>
	</div>
</div>
<script>
	GetDivs();
	HideAll();
	var objects = [];
	
	function ToggleGroups(){
		if(document.getElementById("group_list").style.display != "none"){
			document.getElementById("group_list").style.display = "none";
			document.getElementById("img_groupToggle").src = "/Icons/Show.png";
		}else{
			document.getElementById("group_list").style.display = "inline";
			document.getElementById("img_groupToggle").src = "/Icons/Hide.png";
		}
	}
	function ToggleCases(){
		if(document.getElementById("case_list").style.display != "none"){
			document.getElementById("case_list").style.display = "none";
			document.getElementById("img_caseToggle").src = "/Icons/Show.png";
		}else{
			document.getElementById("case_list").style.display = "inline";
			document.getElementById("img_caseToggle").src = "/Icons/Hide.png";
		}
	}
	
	function update(){
		var max = 0;
		var childs = document.getElementById("holder").children;
		document.getElementById("post_elements").value = "";
		document.getElementById("post_elements").value = childs[0].dataset.id;
		if(childs[0].dataset.level > max){
			max = childs[0].dataset.level
		}
		for(i = 1; i < childs.length; i++){
			document.getElementById("post_elements").value += "," + childs[i].dataset.id;
			if(childs[i].dataset.level > max){
				max = childs[i].dataset.level
			}
		}
		
		document.getElementById("post_level").value = parseInt(max) +1;
	}
	
	function AddMe(id, group){
		var target = document.getElementById(id);
		var obj = document.createElement('div');
		obj.id = target.dataset.addid;
		
		if(group == true){
			obj.setAttribute("class", "group");
			document.getElementById("post_elements").value += "," + target.dataset.addid;
			obj.dataset.id = target.dataset.id;
		}else{
			obj.setAttribute("class", "case");
			document.getElementById("post_elements").value += "," + target.dataset.addid;
			obj.dataset.id = target.dataset.addid;		
		}
		//obj.dataset.level = target.dataset.level;
		//obj.setAttribute("onclick", "RemoveMe(event)");
		//obj.innerHTML = target.innerHTML;
		//obj.style.color = "#A62222";
		//obj.style.cursor = "pointer";
		document.getElementById("holder").appendChild(obj);
		//update();
	}
	
	function RemoveMe(event){
		document.getElementById("holder").removeChild(event.target);
		update();
	}
</script>